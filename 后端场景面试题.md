# 📚 后端场景面试题大全

## 🔐 用户认证与权限

### 1. 如何设计安全的用户认证系统？
**答案**：
1. 密码加盐哈希存储
2. 多因素认证
3. JWT/OAuth2.0
4. 会话超时机制
5. 登录失败限制

### 2. RBAC和ABAC有什么区别？
**答案**：
| 模型 | RBAC | ABAC |
|------|------|------|
| 控制维度 | 角色 | 属性 |
| 灵活性 | 低 | 高 |
| 复杂度 | 简单 | 复杂 |
| 适用场景 | 固定权限 | 动态权限 |

## 💰 支付流程

### 3. 如何设计防重放的支付系统？
**答案**：
1. 唯一订单号
2. 时间戳验证
3. 签名机制
4. 幂等接口设计

### 4. 如何处理支付回调通知？
**答案**：
1. 验证签名
2. 检查订单状态
3. 异步处理
4. 失败重试机制

## 🛒 订单处理

### 5. 如何保证订单状态一致性？
**答案**：
1. 状态机设计
2. 分布式事务
3. 补偿机制
4. 对账系统

### 6. 如何处理订单超时未支付？
**答案**：
1. 延迟队列
2. 定时任务扫描
3. 状态回滚
4. 库存释放

## ⚡ 高并发秒杀

### 7. 秒杀系统设计要点？
**答案**：
1. 流量削峰
2. 缓存预热
3. 库存分段
4. 异步下单

### 8. 如何防止超卖？
**答案**：
1. Redis原子操作
2. 乐观锁
3. 预扣库存
4. 队列串行化

## 🔄 数据一致性

### 9. CAP理论如何应用？
**答案**：
1. CP系统: 分布式锁
2. AP系统: 最终一致性
3. 根据业务选择

### 10. 如何实现最终一致性？
**答案**：
1. 消息队列
2. 定时任务
3. 对账修复
4. 版本控制

## 💾 事务隔离

### 11. 事务隔离级别有哪些？
**答案**：
1. 读未提交
2. 读已提交
3. 可重复读
4. 串行化

### 12. 如何解决幻读？
**答案**：
1. 间隙锁
2. 串行化隔离
3. 乐观锁版本控制

## 📝 日志系统

### 13. 如何设计日志收集系统？
**答案**：
1. ELK栈
2. 日志分级
3. 结构化格式
4. 采样策略

### 14. 如何实现日志追踪？
**答案**：
1. TraceID贯穿
2. 调用链记录
3. 可视化展示

## 🔄 接口幂等

### 15. 什么是幂等性？
**答案**：
多次请求与单次请求效果相同

### 16. 如何保证接口幂等？
**答案**：
1. 唯一请求ID
2. 乐观锁
3. 状态机
4. Token机制

## 🌐 分布式系统

### 17. 如何设计分布式锁？
**答案**：
1. Redis SETNX
2. Zookeeper
3. 数据库唯一约束

### 18. 如何解决分布式事务？
**答案**：
1. 2PC/3PC
2. TCC
3. SAGA
4. 本地消息表

## 🚀 性能优化

### 19. 如何优化慢查询？
**答案**：
1. 索引优化
2. 分库分表
3. 缓存策略
4. SQL重构

### 20. 如何设计缓存策略？
**答案**：
1. 多级缓存
2. 缓存穿透防护
3. 一致性哈希
4. 热点数据预加载

## 🔍 问题排查

### 21. 如何定位内存泄漏？
**答案**：
1. Heap Dump
2. GC日志分析
3. 引用链追踪

### 22. 如何分析CPU飙高？
**答案**：
1. 线程堆栈
2. 火焰图
3. 热点方法定位

## 🛠️ 系统设计

### 23. 如何设计短链服务？
**答案**：
1. 发号器
2. 哈希算法
3. 缓存优化
4. 过期策略

### 24. 如何设计Feed流？
**答案**：
1. 推模式
2. 拉模式
3. 推拉结合
4. 分片策略

## 🔒 安全防护

### 25. 如何防止XSS攻击？
**答案**：
1. 输入过滤
2. 输出编码
3. CSP策略

### 26. 如何防止CSRF攻击？
**答案**：
1. Token验证
2. SameSite Cookie
3. 验证Referer

## 📦 消息队列

### 27. 如何保证消息不丢失？
**答案**：
1. 持久化
2. ACK机制
3. 重试策略

### 28. 如何避免消息重复消费？
**答案**：
1. 幂等设计
2. 去重表
3. 业务状态检查

## 🧩 设计模式

### 29. 常用设计模式有哪些？
**答案**：
1. 工厂模式
2. 策略模式
3. 观察者模式
4. 装饰器模式

### 30. 如何实现熔断降级？
**答案**：
1. 熔断器模式
2. 限流算法
3. 服务降级预案

## 🏗️ 架构设计

### 31. 微服务拆分原则？
**答案**：
1. 单一职责
2. 业务边界
3. 数据自治
4. 演进式拆分

### 32. 如何设计API网关？
**答案**：
1. 路由转发
2. 鉴权中心
3. 限流熔断
4. 监控日志

## 🚦 高可用

### 33. 如何设计容灾方案？
**答案**：
1. 多机房部署
2. 数据同步
3. 流量切换

### 34. 如何实现蓝绿部署？
**答案**：
1. 双环境
2. 流量切换
3. 回滚机制

## 🔄 数据迁移

### 35. 如何安全迁移数据库？
**答案**：
1. 双写方案
2. 增量同步
3. 数据校验

### 36. 如何处理大数据量迁移？
**答案**：
1. 分批次
2. 并行处理
3. 断点续传

## 💡 新技术

### 37. Service Mesh解决了什么问题？
**答案**：
1. 服务通信治理
2. 可观测性
3. 流量控制

### 38. Serverless适用场景？
**答案**：
1. 事件驱动
2. 流量波动大
3. 短时任务

## 🛠️ 运维相关

### 39. 如何设计监控系统？
**答案**：
1. 指标采集
2. 告警规则
3. 可视化

### 40. 如何实现自动化发布？
**答案**：
1. CI/CD流水线
2. 审批流程
3. 回滚机制

## 🔍 性能测试

### 41. 如何进行压力测试？
**答案**：
1. 基准测试
2. 负载测试
3. 稳定性测试

### 42. 如何分析性能瓶颈？
**答案**：
1. 链路追踪
2. 资源监控
3. 火焰图

## 🧠 算法应用

### 43. 常用限流算法？
**答案**：
1. 令牌桶
2. 漏桶
3. 滑动窗口

### 44. 如何实现分布式ID？
**答案**：
1. Snowflake
2. UUID
3. 数据库序列

## 🌍 国际化

### 45. 如何处理多语言？
**答案**：
1. 资源文件
2. 语言标识
3. 动态切换

### 46. 如何设计时区系统？
**答案**：
1. UTC存储
2. 本地化显示
3. 时区转换

## 📊 数据分析

### 47. 如何设计数据统计？
**答案**：
1. 预聚合
2. 实时计算
3. 离线分析

### 48. 如何优化大数据查询？
**答案**：
1. 列式存储
2. 分区策略
3. 物化视图

## 🔗 第三方集成

### 49. 如何设计API对接？
**答案**：
1. 认证机制
2. 限流策略
3. 错误处理

### 50. 如何保证接口兼容性？
**答案**：
1. 版本控制
2. 灰度发布
3. 兼容层设计

## 🚀 前沿技术

### 51. 云原生技术栈有哪些？
**答案**：
1. Kubernetes
2. Service Mesh
3. Serverless

### 52. 微服务监控要点？
**答案**：
1. 链路追踪
2. 指标监控
3. 日志聚合

## 🏆 最佳实践

### 53. 代码规范如何落地？
**答案**：
1. 自动化检查
2. 代码评审
3. 持续集成

### 54. 如何设计技术方案文档？
**答案**：
1. 背景目标
2. 架构设计
3. 风险评估
4. 实施计划

## 题目 55：

**问题：** 设计一个高并发秒杀系统，需要考虑哪些关键点？如何解决超卖问题？

**答案：**

1. 关键设计点：
   - 分层架构：前端静态化 + 中间层限流 + 后端异步处理
   - 缓存策略：多级缓存（CDN + Redis + 本地缓存）
   - 数据库优化：分库分表 + 读写分离
   - 服务降级：非核心功能可降级
   - 监控报警：实时监控QPS、库存等关键指标

2. 超卖解决方案：
   - Redis原子操作（DECR + WATCH）
   - 分布式锁（Redisson）
   - 预扣库存 + 异步支付
   - 消息队列削峰填谷（Kafka/RocketMQ）

## 题目 56：

**问题：** 如何设计一个分布式ID生成服务？对比雪花算法和UUID方案的优缺点。

**答案：**

1. 设计要点：
   - 全局唯一性
   - 趋势递增
   - 高可用性
   - 低延迟

2. 方案对比：
   - 雪花算法：
     ✓ 有序且可反解时间戳
     ✗ 依赖时钟同步
   - UUID：
     ✓ 无需协调
     ✗ 无序且存储空间大

3. 推荐方案：
   - 美团Leaf
   - 百度UidGenerator
   - 自研改进版雪花算法

